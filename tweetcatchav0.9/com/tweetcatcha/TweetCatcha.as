package com.tweetcatcha {		import flash.display.MovieClip;	import flash.events.*;	import flash.net.URLRequest;	import flash.display.Loader;	import flash.system.ApplicationDomain;		import com.tweetcatcha.data.Newswire;	import com.tweetcatcha.data.objects.NewsItem;	import com.tweetcatcha.data.objects.Tweet;	import com.tweetcatcha.data.Constants;	//import com.tweetcatcha.nav.MainNav;	import com.tweetcatcha.visual.DreamweaverZoomView;		import com.tweetcatcha.events.TweetIDEvent;	import com.reintroducing.events.CustomEvent;		//HEADLINE VIEW	import com.tweetcatcha.visual.HeadlineView;	import com.tweetcatcha.nav.DateSelectionNavigation;		//BOTTOM NAV	import com.tweetcatcha.nav.BottomNavMain;		public class TweetCatcha extends MovieClip {				public static const SCRIPT_BASE_LOC		:String = "http://localhost:8888/Tweetcatcha/getData/"				private var NW				:Newswire;		private var DW				:DreamweaverZoomView;		//private var MN				:MainNav = new MainNav();				//HEADLINE VIEW		private var HV				:HeadlineView;		private var DSN				:DateSelectionNavigation;				//BOTTOM NAV		private var BN				:BottomNavMain;				private var STAGE_WIDTH, STAGE_HEIGHT	:Number;		private var _initDate		:String = '2009-11-12';				//constructor		public function TweetCatcha() {						dreamweaver_mc.circleClip.circleContent_mc.alpha = 0;						stage.align = "TL";			stage.scaleMode = "noScale";						root.loaderInfo.addEventListener(Event.COMPLETE, _onRootLoaded);		}		public function _onRootLoaded($e:Event):void {			root.loaderInfo.removeEventListener(Event.COMPLETE, _onRootLoaded);			if (root.loaderInfo.parameters.date) _initDate = root.loaderInfo.parameters.date;			if (_checkStageDimens()) {				initiation();			} else {				addEventListener(Event.ENTER_FRAME, _onStageEnterFrameHandler);			}		}		private function _checkStageDimens():Boolean {			if (stage.stageWidth > 10) {				if (stage.stageHeight > 10) {					STAGE_WIDTH = stage.stageWidth;					STAGE_HEIGHT = stage.stageHeight;					return true;				}			}			return false;		}		private function _onStageEnterFrameHandler($e:Event):void {			trace("TweetCatcha :: _onStageEnterFrameHandler : no stage sizes");			if (_checkStageDimens()) {				initiation();			}		}				public function initiation():void {			removeEventListener(Event.ENTER_FRAME, _onStageEnterFrameHandler);			NW = new Newswire( SCRIPT_BASE_LOC );						DW = new DreamweaverZoomView();			DW.mc = dreamweaver_mc;			//MN.mc = mainMenuHolda_mc;			DW.onStageResize(stage.stageWidth, stage.stageHeight);			DW.setup();			//dreamweaver_mc.mask = mainMask;						DW.addEventListener(Constants.HEADLINE_ID_SELECTED, _onHeadlineSelected, false, 0, true);			DW.addEventListener(Constants.ZOOM_IN_CLICK, _onZoomClick, false, 0, true);			DW.addEventListener(Constants.ZOOM_OUT_CLICK, _onZoomOutClick, false, 0, true);						NW.addEventListener(Event.COMPLETE, _onNewswireLoaded, false, 0, true);						stage.addEventListener(Event.RESIZE, _onStageResize);						//HEADLINE VIEW			HV = new HeadlineView();			addChild(HV);			HV.addEventListener(Constants.HEADLINE_ID_SELECTED, _onHeadlineSelected, false, 0, true);			HV.onStageResize(stage.stageWidth, stage.stageHeight);						DSN = new DateSelectionNavigation(  );			DSN.setup( SCRIPT_BASE_LOC );			addChild(DSN);			DSN.addEventListener(Constants.DATE_SELECTED, _onDateSelected, false, 0, true);			DSN.onStageResize(stage.stageWidth, stage.stageHeight);						loadTweetsForDate(_initDate);						//***************************************** TEMPORARY HEADLINE VIEW BUTTON ****************			//headlineviewBtn.addEventListener(MouseEvent.MOUSE_DOWN, _onHeadlineView, false, 0, true);						//zoom headline header text			zoomHeader.visible = false;			zoomHeader.alpha = 0;						loadAssets();						bg_mc.x = stage.stageWidth * .5;			bg_mc.y = stage.stageHeight * .5;		}				public function loadAssets():void {			var loader:Loader = new Loader();			loader.contentLoaderInfo.addEventListener(Event.COMPLETE, _onBNLoaded, false, 0, true);			loader.load(new URLRequest("_swf/BottomNav.swf"));		}		public function _onBNLoaded($e:Event):void {			BN = new BottomNavMain( MovieClip($e.target.content) );			$e.currentTarget.loader.contentLoaderInfo.removeEventListener(Event.COMPLETE, _onBNLoaded);			BN.setup();						BN.onStageResize(stage.stageWidth, stage.stageHeight);			//BN.hideNav();			BN.addEventListener(Constants.LIST_VIEW_CLICKED, _onListViewClicked, false, 0, true);			BN.addEventListener(Constants.DATE_VIEW_CLICKED, _onShowDateNavClicked, false, 0, true);			addChild( BN.mc );		}				public function loadTweetsForDate($date:String):void {			DW.showLoaderAnim();			NW.load($date, 60);		}				public function _onNewswireLoaded($e:Event):void {			//trace("Main :: _onNewswireLoaded : Total newsItems "+NW.newsItems.length);			//for (var i:int = 0; i < NW.newsItems.length; i++) {				//var ni:NewsItem = NW.newsItems[i];				//trace("\n\n\n****************************************************************");				//trace(ni.headline+" date: "+ni.month+"-"+ni.day+"-"+ni.year);				//trace("Tweets -------------------"+NW.newsItems[i].tweets.length);				//for (var j:int = 0; j < NW.newsItems[i].tweets.length; j++) {					//trace("          +"+NW.newsItems[i].tweets[j].user);				//}			//}						DW.hideLoaderAnim();						DW.reset();			DW.newsItems = NW.newsItems;			DW.configure();			DW.positionAllTweets();						//HEADLINE VIEW			HV.newsItems = NW.newsItems;			HV.setup();						_onHeadlineClick( Math.random() * NW.newsItems.length );						BN.showNav();					}				public function _onHeadlineSelected($e:CustomEvent = null):void {			_onHeadlineClick( $e.params.ID );		}				public function _onHeadlineClick( $id:int ):void {						dreamweaver_mc.circleClip.circleContent_mc.alpha = 1;						DW.headlineSelected( $id );			//trace("tweets = " + NW.newsItems[$id].totalTweets);			//set the headline and num tweets for the header on zoom in			zoomHeader.zoomHeadline.htmlText = NW.newsItems[$id].headline;			zoomHeader.zoomTweets.htmlText = NW.newsItems[$id].totalTweets + " tweets";		}				private function _onStageResize( $e:Event ):void {			var w:Number = $e.target.stageWidth;			var h:Number = $e.target.stageHeight;			DW.onStageResize(w, h);			BN.onStageResize(w, h);			// 60 is the height of the bottom nav			DSN.onStageResize(w, h - 60);			HV.onStageResize(w, h - 60);						if (!DW.bZoomedIn) {				bg_mc.x = w * .5;				bg_mc.y = h * .5;			}		}				public function _onZoomClick($e:CustomEvent) {			zoomIn($e);		}		public function zoomIn($e:CustomEvent):void {			bg_mc.x = bg_mc.y = 0;			BN.hideNav();			DW.zoomIn($e);			DW.showZoomHeader(zoomHeader);		}				public function _onZoomOutClick($e:CustomEvent):void {			zoomOut($e);		}		public function zoomOut($e:CustomEvent):void {			bg_mc.x = stage.stageWidth * .5;			bg_mc.y = stage.stageHeight * .5;						BN.showNav();			DW.zoomOut( $e );			DW.hideZoomHeader(zoomHeader);		}				/*private function _onMouseMove($e:MouseEvent):void {			MN.checkMouse( mouseY );		}*/				public function _onListViewClicked($e:Event = null):void {			HV.openHV();			DSN.closeDSN();		}		public function _onShowDateNavClicked($e:Event = null):void {			DSN.openDSN();			HV.closeHV();		}				public function _onDateSelected($e:CustomEvent = null):void {			loadTweetsForDate( String($e.params.date) );		}				}}